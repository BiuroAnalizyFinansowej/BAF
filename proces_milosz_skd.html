<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator SKD - WARIANT 1</title>
    
    <link rel="icon" type="image/png" href="baf_logo_p.png">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* =====================================
           KAF CALCULATOR UNIFIED DESIGN
           Styl skopiowany z wps.html
        ===================================== */
        
        /* Reset & Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #2d3748;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        /* Header with Navigation */
        .calc-header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 1rem 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .header-left-group {
            display: flex;
            align-items: center;
            gap: 1.5rem; /* Odstęp między tytułem a przyciskiem */
        }

        .header-center-group {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1e293b;
        }
        
        .calc-brand {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .calc-logo {
            height: 40px;
            width: 40px;
            border-radius: 8px;
        }
        
        .calc-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1e293b;
            margin: 0;
        }
        
        .nav-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.6rem 1rem;
            background: #f1f5f9;
            color: #64748b;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-weight: 500;
            border: none;
            cursor: pointer;
        }
        
        .nav-btn:hover {
            background: #1e40af;
            color: white;
            transform: translateY(-1px);
        }
        
        /* Main Container */
        .calc-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
            padding: 0 1rem;
        }
        
        /* Section styles */
        .calc-section {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .section-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .section-title i {
            color: #1e40af;
        }

        /* Table styles */
        .calc-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .calc-table td {
            padding: 0.75rem 0.5rem;
            border-bottom: 1px solid #f1f5f9;
            font-size: 0.9rem;
        }
        
        .calc-table tr:last-child td {
            border-bottom: none;
        }

        .calc-table td:first-child {
            font-weight: 500;
            color: #374151;
            width: 50%;
        }

        .calc-table td a {
            color: inherit;
            text-decoration: none;
            border-bottom: 1px dashed #1e40af;
        }

        .calc-table td a:hover {
            color: #1e40af;
        }
        
        .calc-table td:nth-child(2) {
            text-align: right;
        }
        
        /* Input Field */
        .input-field {
            width: 100%;
            padding: 0.5rem 0.8rem;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 0.9rem;
            background: #f8fafc;
            transition: all 0.2s ease;
            text-align: right;
            font-weight: 600;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #1e40af;
            background: white;
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .input-field[readonly] {
            background: #e2e8f0;
            color: #475569;
            cursor: not-allowed;
            border-color: #e2e8f0;
        }
        
        .output-field {
            font-weight: 700;
            color: #1e293b;
        }
        
        .highlight {
            color: #1e40af;
            font-size: 1.1rem;
        }

        .highlight-success {
            color: #16a34a;
            font-size: 1.1rem;
        }
        
        .calc-actions {
            margin-top: auto; /* Pushes button to the bottom */
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }
        
        .calc-btn {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: #f1f5f9;
            color: #64748b;
        }
        
        .calc-btn:hover {
            background: #e2e8f0;
            color: #374151;
        }

        /* Specific table headers */
        .calc-table th {
            text-align: right;
            padding: 0.5rem;
            font-size: 0.8rem;
            color: #64748b;
            border-bottom: 2px solid #e2e8f0;
        }
        .calc-table th:first-child {
            text-align: left;
        }
    </style>
</head>
<body>
    <header class="calc-header">
        <div class="header-left-group">
            <div class="calc-brand">
                <i class="fas fa-calculator calc-logo" style="background: #1e40af; color: white; padding: 10px; font-size: 20px;"></i>
                <h1 class="calc-title">Kalkulator SKD</h1>
            </div>
             <a href="javascript:history.back()" class="nav-btn">
                <i class="fas fa-arrow-left"></i> Powrót
            </a>
        </div>
        <div class="header-center-group">
            WARIANT 1
        </div>
        <div>
            <img src="baf_logo.png" alt="Logo BAF" style="height: 50px;">
        </div>
    </header>

    <main class="calc-container">
        <div style="display: flex; flex-direction: column; gap: 1.5rem;">
            <section class="calc-section">
                <h2 class="section-title"><i class="fas fa-keyboard"></i>Dane do wprowadzenia</h2>
                <table class="calc-table">
                    <tr>
                        <td>WPS</td>
                        <td><input type="number" id="wps" class="input-field" value="49478.40"></td>
                    </tr>
                    <tr>
                        <td>Odsetki przyszłe do umorzenia</td>
                        <td><input type="number" id="odsetki_przyszle" class="input-field" value="3016.30"></td>
                    </tr>
                    <tr>
                        <td>
                             <a href="https://wskazniki.gofin.pl/wskaznik/70/odsetki-ustawowe" target="_blank" title="Sprawdź aktualne stawki">
                                Aktualna stawka % odsetek ustawowych
                             </a>
                        </td>
                        <td><input type="number" id="stawka_odsetek_ust" class="input-field" value="10.50"></td>
                    </tr>
                    <tr>
                        <td>Nasze Success fee %</td>
                        <td><input type="number" id="nasze_sf_proc" class="input-field" value="0"></td>
                    </tr>
                </table>
            </section>
            
            <section class="calc-section">
                <h2 class="section-title"><i class="fas fa-file-invoice-dollar"></i>Opłaty początkowe</h2>
                 <table class="calc-table">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Netto</th>
                            <th>Brutto</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Pre opłaty Miłosz</td>
                            <td><input type="number" id="pre_milosz_netto" class="input-field" value="2250" readonly></td>
                            <td class="output-field" id="pre_milosz_brutto"></td>
                        </tr>
                        <tr>
                            <td>Pre opłaty KAF</td>
                            <td><input type="number" id="pre_kaf_netto" class="input-field" value="10390.46"></td>
                            <td class="output-field" id="pre_kaf_brutto"></td>
                        </tr>
                        <tr>
                            <td>Opłata sądowa + pełnomocnictwo</td>
                            <td><input type="number" id="oplata_sadowa_netto" class="input-field" value="1017"></td>
                            <td class="output-field" id="oplata_sadowa_brutto"></td>
                        </tr>
                         <tr>
                            <td>II instancja</td>
                            <td><input type="number" id="ii_instancja_netto" class="input-field" value="750" readonly></td>
                            <td class="output-field" id="ii_instancja_brutto"></td>
                        </tr>
                        <tr>
                            <td><b>Sumaryczne Pre opłaty</b></td>
                            <td class="output-field" id="sum_pre_netto"></td>
                            <td class="output-field highlight" id="sum_pre_brutto"></td>
                        </tr>
                         <tr>
                            <td><b>Sumaryczne Pre opłaty + II instancja</b></td>
                            <td class="output-field" id="sum_pre_ii_netto"></td>
                            <td class="output-field highlight" id="sum_pre_ii_brutto"></td>
                        </tr>
                    </tbody>
                </table>
            </section>
            
            <section class="calc-section">
                 <div class="calc-actions">
                    <button class="calc-btn" id="reset-btn">
                        <i class="fas fa-undo"></i> Wyczyść
                    </button>
                </div>
            </section>
        </div>

        <div style="display: flex; flex-direction: column; gap: 1.5rem;">
             <section class="calc-section">
                <h2 class="section-title"><i class="fas fa-percentage"></i>Success Fee</h2>
                 <table class="calc-table">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Netto</th>
                            <th>Brutto</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Miłosz success fee (6% od WPS)</td>
                            <td class="output-field" id="sf_milosz_netto"></td>
                            <td class="output-field" id="sf_milosz_brutto"></td>
                        </tr>
                        <tr>
                            <td>KAF success fee</td>
                            <td class="output-field" id="sf_kaf_netto"></td>
                            <td class="output-field" id="sf_kaf_brutto"></td>
                        </tr>
                        <tr>
                            <td><b>Sumaryczne success fee</b></td>
                            <td class="output-field" id="sum_sf_netto"></td>
                            <td class="output-field highlight" id="sum_sf_brutto"></td>
                        </tr>
                    </tbody>
                </table>
            </section>
            
            <section class="calc-section">
                <h2 class="section-title"><i class="fas fa-chart-pie"></i>Podsumowanie</h2>
                <table class="calc-table">
                    <tr>
                        <td>Odsetki ustawowe za opóźnienie (1 rok)</td>
                        <td class="output-field" id="odsetki_1rok"></td>
                    </tr>
                    <tr>
                        <td>Odsetki ustawowe za opóźnienie (2 lata)</td>
                        <td class="output-field" id="odsetki_2lata"></td>
                    </tr>
                    <tr>
                        <td><b>Sumarycznie do odzyskania</b></td>
                        <td class="output-field highlight" id="sum_do_odzyskania"></td>
                    </tr>
                    <tr>
                        <td>WPS finalny z odsetkami za opóźnienie</td>
                        <td class="output-field" id="wps_finalny"></td>
                    </tr>
                     <tr>
                        <td>Stosunek pre opłat do sumy do odzyskania</td>
                        <td class="output-field" id="stosunek_pre_do_sumy"></td>
                    </tr>
                     <tr>
                        <td><b>Zysk Klienta po rozliczeniu inwestycji</b></td>
                        <td class="output-field highlight-success" id="zysk_klienta"></td>
                    </tr>
                    <tr>
                        <td>Podział procentowy dla klienta</td>
                        <td class="output-field" id="podzial_klient"></td>
                    </tr>
                    <tr>
                        <td>Podział procentowy dla nas</td>
                        <td class="output-field" id="podzial_nasz"></td>
                    </tr>
                </table>
            </section>
            
             <section class="calc-section">
                <h2 class="section-title"><i class="fas fa-credit-card"></i>Opcje ratalne PAYU</h2>
                <table class="calc-table">
                    <thead>
                        <tr>
                            <th>Liczba rat</th>
                            <th>Prowizja PAYU</th>
                            <th>Kwota raty</th>
                            <th>Nasz zysk Pre (netto)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>5</td>
                            <td class="output-field" id="payu_prowizja_5"></td>
                            <td class="output-field" id="payu_rata_5"></td>
                            <td class="output-field" id="payu_zysk_5"></td>
                        </tr>
                        <tr>
                            <td>10</td>
                            <td class="output-field" id="payu_prowizja_10"></td>
                            <td class="output-field" id="payu_rata_10"></td>
                            <td class="output-field" id="payu_zysk_10"></td>
                        </tr>
                         <tr>
                            <td>20</td>
                            <td class="output-field" id="payu_prowizja_20"></td>
                            <td class="output-field" id="payu_rata_20"></td>
                            <td class="output-field" id="payu_zysk_20"></td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const inputs = document.querySelectorAll('.input-field');
            
            // Helper functions
            const formatCurrency = (value) => new Intl.NumberFormat('pl-PL', { style: 'currency', currency: 'PLN' }).format(value);
            const formatPercent = (value) => new Intl.NumberFormat('pl-PL', { style: 'percent', minimumFractionDigits: 2 }).format(value);
            const getValue = (id) => parseFloat(document.getElementById(id).value) || 0;
            const setValue = (id, value, formatFn) => {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = formatFn ? formatFn(value) : value;
                }
            };
            
            function calculate() {
                try {
                    // Stałe
                    const VAT_RATE = 0.23;
                    const PAYU_RATES = {
                        5: 0.0449,
                        10: 0.0449,
                        20: 0.0699,
                    };

                    // === Pobieranie wartości z inputów ===
                    const wps = getValue('wps');
                    const odsetkiPrzyszle = getValue('odsetki_przyszle');
                    const stawkaOdsetekUst = getValue('stawka_odsetek_ust') / 100;
                    const naszeSfProc = getValue('nasze_sf_proc') / 100;
                    
                    const preMiloszNetto = getValue('pre_milosz_netto');
                    const preKafNetto = getValue('pre_kaf_netto');
                    const oplataSadowaNetto = getValue('oplata_sadowa_netto');
                    const iiInstancjaNetto = getValue('ii_instancja_netto');

                    // === Obliczenia: Opłaty początkowe ===
                    const preMiloszBrutto = preMiloszNetto * (1 + VAT_RATE);
                    const preKafBrutto = preKafNetto * (1 + VAT_RATE);
                    const oplataSadowaBrutto = oplataSadowaNetto; // bez VAT
                    const iiInstancjaBrutto = iiInstancjaNetto * (1 + VAT_RATE);
                    
                    const sumPreNetto = preMiloszNetto + preKafNetto + oplataSadowaNetto;
                    const sumPreBrutto = preMiloszBrutto + preKafBrutto + oplataSadowaBrutto;
                    
                    const sumPreIiNetto = sumPreNetto + iiInstancjaNetto;
                    const sumPreIiBrutto = sumPreBrutto + iiInstancjaBrutto;

                    // === Obliczenia: Podsumowanie ===
                    const odsetki1rok = wps * stawkaOdsetekUst;
                    const odsetki2lata = odsetki1rok * 2;
                    const sumDoOdzyskania = wps + odsetkiPrzyszle + odsetki2lata;
                    const wpsFinalny = wps + odsetki2lata;
                    const stosunekPreDoSumy = sumDoOdzyskania > 0 ? sumPreIiBrutto / sumDoOdzyskania : 0;

                    // === Obliczenia: Success Fee ===
                    const sfMiloszNetto = wps * 0.06;
                    const sfMiloszBrutto = sfMiloszNetto * (1 + VAT_RATE);

                    // Jeśli KAF SF < 0, pokaż 0
                    const sfKafNetto = Math.max(0, (sumDoOdzyskania * naszeSfProc) - sfMiloszNetto);
                    const sfKafBrutto = sfKafNetto * (1 + VAT_RATE);

                    const sumSfNetto = sfMiloszNetto + sfKafNetto;
                    const sumSfBrutto = sfMiloszBrutto + sfKafBrutto;

                    // === Obliczenia: Finalne podsumowanie ===
                    const zyskKlienta = sumDoOdzyskania - sumPreIiBrutto - sumSfBrutto;
                    const podzialKlient = sumDoOdzyskania > 0 ? zyskKlienta / sumDoOdzyskania : 0;
                    const podzialNasz = 1 - podzialKlient;
                    
                    // === Obliczenia: PAYU ===
                    const kwotaDoRozlozenia = sumPreIiBrutto;
                    
                    // Raty: 5
                    const prowizja5 = kwotaDoRozlozenia * PAYU_RATES[5];
                    const rata5 = (kwotaDoRozlozenia + prowizja5) / 5;
                    const zysk5 = preKafNetto - (prowizja5 / (1 + VAT_RATE)); // Zysk NETTO

                    // Raty: 10
                    const prowizja10 = kwotaDoRozlozenia * PAYU_RATES[10];
                    const rata10 = (kwotaDoRozlozenia + prowizja10) / 10;
                    const zysk10 = preKafNetto - (prowizja10 / (1 + VAT_RATE)); // Zysk NETTO

                    // Raty: 20
                    const prowizja20 = kwotaDoRozlozenia * PAYU_RATES[20];
                    const rata20 = (kwotaDoRozlozenia + prowizja20) / 20;
                    const zysk20 = preKafNetto - (prowizja20 / (1 + VAT_RATE)); // Zysk NETTO

                    // === Aktualizacja interfejsu ===
                    // Opłaty początkowe
                    setValue('pre_milosz_brutto', preMiloszBrutto, formatCurrency);
                    setValue('pre_kaf_brutto', preKafBrutto, formatCurrency);
                    setValue('oplata_sadowa_brutto', oplataSadowaBrutto, formatCurrency);
                    setValue('ii_instancja_brutto', iiInstancjaBrutto, formatCurrency);
                    setValue('sum_pre_netto', sumPreNetto, formatCurrency);
                    setValue('sum_pre_brutto', sumPreBrutto, formatCurrency);
                    setValue('sum_pre_ii_netto', sumPreIiNetto, formatCurrency);
                    setValue('sum_pre_ii_brutto', sumPreIiBrutto, formatCurrency);
                    
                    // Podsumowanie
                    setValue('odsetki_1rok', odsetki1rok, formatCurrency);
                    setValue('odsetki_2lata', odsetki2lata, formatCurrency);
                    setValue('sum_do_odzyskania', sumDoOdzyskania, formatCurrency);
                    setValue('wps_finalny', wpsFinalny, formatCurrency);
                    setValue('stosunek_pre_do_sumy', stosunekPreDoSumy, formatPercent);
                    setValue('zysk_klienta', zyskKlienta, formatCurrency);
                    setValue('podzial_klient', podzialKlient, formatPercent);
                    setValue('podzial_nasz', podzialNasz, formatPercent);

                    // Success Fee
                    setValue('sf_milosz_netto', sfMiloszNetto, formatCurrency);
                    setValue('sf_milosz_brutto', sfMiloszBrutto, formatCurrency);
                    setValue('sf_kaf_netto', sfKafNetto, formatCurrency);
                    setValue('sf_kaf_brutto', sfKafBrutto, formatCurrency);
                    setValue('sum_sf_netto', sumSfNetto, formatCurrency);
                    setValue('sum_sf_brutto', sumSfBrutto, formatCurrency);
                    
                    // PAYU
                    setValue('payu_prowizja_5', prowizja5, formatCurrency);
                    setValue('payu_rata_5', rata5, formatCurrency);
                    setValue('payu_zysk_5', zysk5, formatCurrency);
                    setValue('payu_prowizja_10', prowizja10, formatCurrency);
                    setValue('payu_rata_10', rata10, formatCurrency);
                    setValue('payu_zysk_10', zysk10, formatCurrency);
                    setValue('payu_prowizja_20', prowizja20, formatCurrency);
                    setValue('payu_rata_20', rata20, formatCurrency);
                    setValue('payu_zysk_20', zysk20, formatCurrency);

                } catch (error) {
                    console.error("Błąd obliczeń:", error);
                }
            }

            function resetForm() {
                // Pola edytowalne
                document.getElementById('wps').value = "49478.40";
                document.getElementById('odsetki_przyszle').value = "3016.30";
                document.getElementById('stawka_odsetek_ust').value = "10.50";
                document.getElementById('nasze_sf_proc').value = "0";
                document.getElementById('pre_kaf_netto').value = "10390.46";
                document.getElementById('oplata_sadowa_netto').value = "1017";

                // Pola zablokowane - nie trzeba resetować, ale dla pewności
                document.getElementById('pre_milosz_netto').value = "2250";
                document.getElementById('ii_instancja_netto').value = "750";

                calculate();
            }

            // Event Listeners
            inputs.forEach(input => input.addEventListener('input', calculate));
            document.getElementById('reset-btn').addEventListener('click', resetForm);

            // Pierwsze obliczenia przy załadowaniu strony
            calculate();
        });
    </script>
</body>
</html>
