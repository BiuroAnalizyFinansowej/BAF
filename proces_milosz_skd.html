<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator SKD - WARIANT 1</title>
    
    <link rel="icon" type="image/png" href="baf_logo_p.png">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* =====================================
           BAF CALCULATOR UNIFIED DESIGN
           Styl skopiowany z wps.html
        ===================================== */
        
        /* Reset & Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #2d3748;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        /* Header with Navigation */
        .calc-header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 1rem 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .header-left-group {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .header-center-group {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1e293b;
        }
        
        .calc-brand {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .calc-logo {
            height: 40px;
            width: 40px;
            border-radius: 8px;
        }
        
        .calc-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1e293b;
            margin: 0;
        }
        
        .nav-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.6rem 1rem;
            background: #f1f5f9;
            color: #64748b;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-weight: 500;
            border: none;
            cursor: pointer;
        }
        
        .nav-btn:hover {
            background: #1e40af;
            color: white;
            transform: translateY(-1px);
        }
        
        /* Main Container */
        .calc-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
            padding: 0 1rem;
        }
        
        /* Section styles */
        .calc-section {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .section-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-subtitle {
            font-size: 0.8rem;
            color: #64748b;
            margin-top: -0.75rem;
            margin-bottom: 1rem;
        }
        
        .section-title i {
            color: #1e40af;
        }

        /* Table styles */
        .calc-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .calc-table td {
            padding: 0.75rem 0.5rem;
            border-bottom: 1px solid #f1f5f9;
            font-size: 0.9rem;
        }
        
        .calc-table tr:last-child td {
            border-bottom: none;
        }

        .calc-table td:first-child {
            font-weight: 500;
            color: #374151;
            width: 50%;
        }

        .calc-table td a {
            color: inherit;
            text-decoration: none;
            border-bottom: 1px dashed #1e40af;
        }

        .calc-table td a:hover {
            color: #1e40af;
        }
        
        .calc-table td:not(:first-child) {
            text-align: right;
        }
        
        /* Input Field */
        .input-field {
            width: 100%;
            padding: 0.5rem 0.8rem;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 0.9rem;
            background: #f8fafc;
            transition: all 0.2s ease;
            text-align: right;
            font-weight: 600;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #1e40af;
            background: white;
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .input-field[readonly] {
            background: transparent;
            color: #2d3748;
            cursor: default;
            border: none;
            padding: 0.5rem 0;
        }
        
        .output-field {
            font-weight: 700;
            color: #1e293b;
        }
        
        .highlight {
            color: #1e40af;
            font-size: 1.1rem;
        }

        .highlight-blue-bg {
            background-color: #e0f2fe;
            border-radius: 6px;
            border: 2px solid #93c5fd;
            padding: 0.5rem 0.8rem !important;
            color: #1e40af;
            font-size: 1.1rem;
            border-bottom: 2px solid #93c5fd !important;
        }

        .highlight-success {
            color: #16a34a;
            font-size: 1.1rem;
        }
        
        .profit-column-header {
            border-top: 2px solid #a7f3d0;
            border-left: 2px solid #a7f3d0;
            border-right: 2px solid #a7f3d0;
            color: #065f46;
            font-weight: 700;
            background-color: #f0fdf4;
        }
        .profit-column-cell {
            border-left: 2px solid #a7f3d0;
            border-right: 2px solid #a7f3d0;
            font-size: 1.05em;
            font-weight: 700;
            background-color: #f0fdf4;
            border-bottom: none;
        }
        .calc-table tr:last-child .profit-column-cell {
            border-bottom: 2px solid #a7f3d0;
        }

        .calc-actions {
            margin-top: auto;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }
        
        .calc-btn {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: #f1f5f9;
            color: #64748b;
            text-decoration: none; /* Dodane dla linku <a> */
        }
        
        .calc-btn:hover {
            background: #e2e8f0;
            color: #374151;
        }
        
        /* Specjalne style dla linku <a> udającego przycisk */
        a.calc-btn:hover {
             transform: translateY(-1px);
        }


        .calc-table th {
            text-align: right;
            padding: 0.5rem;
            font-size: 0.8rem;
            color: #64748b;
            border-bottom: 2px solid #e2e8f0;
        }
        .calc-table th:first-child {
            text-align: left;
        }
    </style>
</head>
<body>
    <header class="calc-header">
        <div class="header-left-group">
            <div class="calc-brand">
                <i class="fas fa-calculator calc-logo" style="background: #1e40af; color: white; padding: 10px; font-size: 20px;"></i>
                <h1 class="calc-title">Kalkulator SKD</h1>
            </div>
             <a href="kalkulatory.html" class="nav-btn">
                <i class="fas fa-arrow-left"></i> Powrót
            </a>
            <a href="index.html" class="nav-btn">
                <i class="fas fa-home"></i> Start
            </a>
        </div>
        <div class="header-center-group">
            WARIANT 1
        </div>
        <div>
            <img src="baf_logo.png" alt="Logo BAF" style="height: 50px;">
        </div>
    </header>

    <main class="calc-container">
        <div style="display: flex; flex-direction: column; gap: 1.5rem;">
            <section class="calc-section">
                <h2 class="section-title"><i class="fas fa-keyboard"></i>Dane do wprowadzenia</h2>
                <table class="calc-table">
                    <tr>
                        <td>WPS</td>
                        <td><input type="number" id="wps" class="input-field" value="0"></td>
                    </tr>
                    <tr>
                        <td>Odsetki przyszłe do umorzenia</td>
                        <td><input type="number" id="odsetki_przyszle" class="input-field" value="0"></td>
                    </tr>
                    <tr>
                        <td>
                             <a href="https://wskazniki.gofin.pl/wskaznik/70/odsetki-ustawowe" target="_blank" title="Sprawdź aktualne stawki">
                                Aktualna stawka % odsetek ustawowych
                             </a>
                        </td>
                        <td><input type="number" id="stawka_odsetek_ust" class="input-field" value="10.00"></td>
                    </tr>
                    <tr>
                        <td>Nasze Success fee %</td>
                        <td><input type="number" id="nasze_sf_proc" class="input-field" value="0"></td>
                    </tr>
                </table>
            </section>
            
            <section class="calc-section">
                <h2 class="section-title"><i class="fas fa-file-invoice-dollar"></i>Opłaty początkowe</h2>
                 <table class="calc-table">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Netto</th>
                            <th>Brutto</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Pre opłaty Miłosz</td>
                            <td><input type="number" id="pre_milosz_netto" class="input-field" value="2250" readonly></td>
                            <td class="output-field" id="pre_milosz_brutto"></td>
                        </tr>
                        <tr>
                            <td>Pre opłaty BAF</td>
                            <td><input type="number" id="pre_baf_netto" class="input-field" value="0"></td>
                            <td class="output-field" id="pre_baf_brutto"></td>
                        </tr>
                        <tr>
                            <td>Opłata sądowa + pełnomocnictwo</td>
                            <td><input type="number" id="oplata_sadowa_netto" class="input-field" value="1017"></td>
                            <td class="output-field" id="oplata_sadowa_brutto"></td>
                        </tr>
                         <tr>
                            <td>II instancja</td>
                            <td><input type="number" id="ii_instancja_netto" class="input-field" value="750" readonly></td>
                            <td class="output-field" id="ii_instancja_brutto"></td>
                        </tr>
                        <tr>
                            <td><b>Sumaryczne Pre opłaty</b></td>
                            <td class="output-field" id="sum_pre_netto"></td>
                            <td class="output-field highlight-blue-bg" id="sum_pre_brutto"></td>
                        </tr>
                         <tr>
                            <td><b>Sumaryczne Pre opłaty + II instancja</b></td>
                            <td class="output-field" id="sum_pre_ii_netto"></td>
                            <td class="output-field highlight" id="sum_pre_ii_brutto"></td>
                        </tr>
                    </tbody>
                </table>
            </section>
            
            <section class="calc-section">
                 <div class="calc-actions" style="display: flex; flex-wrap: wrap; gap: 10px;">
                    <button class="calc-btn" id="reset-btn">
                        <i class="fas fa-undo"></i> Wyczyść
                    </button>
                    
                    <button class="calc-btn" id="generate-page-btn" style="background-color: #1e40af; color: white;">
                        <i class="fas fa-file-export"></i> Generuj ofertę
                    </button>
                    
                    <button id="go-to-generator-btn" class="calc-btn" style="background-color: #a7f3d0; color: #065f46;">
                        <i class="fas fa-file-signature"></i> Przejdź do generowania umowy
                    </button>
                    
                </div>
                 </section>
        </div>

        <div style="display: flex; flex-direction: column; gap: 1.5rem;">
             <section class="calc-section">
                <h2 class="section-title"><i class="fas fa-percentage"></i>Success Fee</h2>
                <p class="section-subtitle">
                    Podane kwoty są jedynie prognozą i uwzględniają % od <b>WPS finalny z odsetkami za opóźnienie</b>.
                </p>
                 <table class="calc-table">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Netto</th>
                            <th>Brutto</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Miłosz success fee (8%)</td>
                            <td class="output-field" id="sf_milosz_netto"></td>
                            <td class="output-field" id="sf_milosz_brutto"></td>
                        </tr>
                        <tr>
                            <td>BAF success fee</td>
                            <td class="output-field" id="sf_baf_netto"></td>
                            <td class="output-field" id="sf_baf_brutto"></td>
                        </tr>
                        <tr>
                            <td><b>Sumaryczne success fee</b></td>
                            <td class="output-field" id="sum_sf_netto"></td>
                            <td class="output-field highlight" id="sum_sf_brutto"></td>
                        </tr>
                    </tbody>
                </table>
            </section>
            
            <section class="calc-section">
                <h2 class="section-title"><i class="fas fa-chart-pie"></i>Podsumowanie</h2>
                <table class="calc-table">
                    <tr>
                        <td>Odsetki ustawowe za opóźnienie (1 rok)</td>
                        <td class="output-field" id="odsetki_1rok"></td>
                    </tr>
                    <tr>
                        <td>Odsetki ustawowe za opóźnienie (2 lata)</td>
                        <td class="output-field" id="odsetki_2lata"></td>
                    </tr>
                    <tr>
                        <td><b>Sumarycznie do odzyskania</b></td>
                        <td class="output-field highlight" id="sum_do_odzyskania"></td>
                    </tr>
                    <tr>
                        <td>WPS finalny z odsetkami za opóźnienie</td>
                        <td class="output-field" id="wps_finalny"></td>
                    </tr>
                     <tr>
                        <td>Stosunek pre opłat do sumy do odzyskania</td>
                        <td class="output-field" id="stosunek_pre_do_sumy"></td>
                    </tr>
                     <tr>
                        <td><b>Zysk Klienta po rozliczeniu inwestycji</b></td>
                        <td class="output-field" id="zysk_klienta"></td>
                    </tr>
                    <tr>
                        <td><b>Stopa zwrotu z inwestycji (ROI)</b></td>
                        <td class="output-field highlight-success" id="roi"></td>
                    </tr>
                    <tr>
                        <td>Podział procentowy dla klienta</td>
                        <td class="output-field" id="podzial_klient"></td>
                    </tr>
                    <tr>
                        <td>Podział procentowy dla nas</td>
                        <td class="output-field" id="podzial_nasz"></td>
                    </tr>
                </table>
            </section>
            
             <section class="calc-section">
                <h2 class="section-title"><i class="fas fa-credit-card"></i>Opcje ratalne PAYU</h2>
                <table class="calc-table">
                    <thead>
                        <tr>
                            <th>Liczba rat</th>
                            <th>Stawka %</th>
                            <th>Prowizja PAYU</th>
                            <th>Kwota raty</th>
                            <th class="profit-column-header">Nasz zysk Pre (netto)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>5</td>
                            <td class="output-field" id="payu_stawka_5"></td>
                            <td class="output-field" id="payu_prowizja_5"></td>
                            <td class="output-field" id="payu_rata_5"></td>
                            <td class="output-field profit-column-cell" id="payu_zysk_5"></td>
                        </tr>
                        <tr>
                            <td>10</td>
                             <td class="output-field" id="payu_stawka_10"></td>
                            <td class="output-field" id="payu_prowizja_10"></td>
                            <td class="output-field" id="payu_rata_10"></td>
                            <td class="output-field profit-column-cell" id="payu_zysk_10"></td>
                        </tr>
                         <tr>
                            <td>20</td>
                             <td class="output-field" id="payu_stawka_20"></td>
                            <td class="output-field" id="payu_prowizja_20"></td>
                            <td class="output-field" id="payu_rata_20"></td>
                            <td class="output-field profit-column-cell" id="payu_zysk_20"></td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const inputs = document.querySelectorAll('.input-field');
            
            const formatCurrency = (value) => {
                if (isNaN(value)) return '';
                return new Intl.NumberFormat('pl-PL', { 
                    style: 'currency', 
                    currency: 'PLN', 
                    useGrouping: true 
                }).format(value);
            }
            const formatPercent = (value) => {
                 if (isNaN(value)) return '';
                return new Intl.NumberFormat('pl-PL', { 
                    style: 'percent', 
                    minimumFractionDigits: 2, 
                    useGrouping: true 
                }).format(value);
            }
            
            const getValue = (id) => parseFloat(document.getElementById(id).value) || 0;
            const setValue = (id, value, formatFn) => {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = formatFn ? formatFn(value) : (value || '');
                }
            };

            const defaultValues = {
                wps: "0",
                odsetki_przyszle: "0",
                stawka_odsetek_ust: "10.00",
                nasze_sf_proc: "0",
                pre_baf_netto: "0", 
                oplata_sadowa_netto: "1017",
                pre_milosz_netto: "2250",
                ii_instancja_netto: "750"
            };
            
            function calculate() {
                try {
                    const VAT_RATE = 0.23;
                    const PAYU_RATES = {
                        5: 0.0449,
                        10: 0.0449,
                        20: 0.0699,
                    };

                    const wps = getValue('wps');
                    const odsetkiPrzyszle = getValue('odsetki_przyszle');
                    const stawkaOdsetekUst = getValue('stawka_odsetek_ust') / 100;
                    const naszeSfProc = getValue('nasze_sf_proc') / 100;
                    
                    const preMiloszNetto = getValue('pre_milosz_netto');
                    const preBafNetto = getValue('pre_baf_netto'); 
                    const oplataSadowaNetto = getValue('oplata_sadowa_netto');
                    const iiInstancjaNetto = getValue('ii_instancja_netto');

                    const preMiloszBrutto = preMiloszNetto * (1 + VAT_RATE);
                    const preBafBrutto = preBafNetto * (1 + VAT_RATE); 
                    const oplataSadowaBrutto = oplataSadowaNetto;
                    const iiInstancjaBrutto = iiInstancjaNetto * (1 + VAT_RATE);
                    
                    const sumPreNetto = preMiloszNetto + preBafNetto + oplataSadowaNetto; 
                    const sumPreBrutto = preMiloszBrutto + preBafBrutto + oplataSadowaBrutto; 
                    
                    const sumPreIiNetto = sumPreNetto + iiInstancjaNetto;
                    const sumPreIiBrutto = sumPreBrutto + iiInstancjaBrutto;

                    const odsetki1rok = wps * stawkaOdsetekUst;
                    const odsetki2lata = odsetki1rok * 2;
                    const wpsFinalny = wps + odsetki2lata;
                    const sumDoOdzyskania = wpsFinalny + odsetkiPrzyszle;
                    
                    const stosunekPreDoSumy = sumDoOdzyskania > 0 ? sumPreBrutto / sumDoOdzyskania : 0;

                    // V --- POPRAWKA TUTAJ --- V
                    const sfMiloszNetto = wpsFinalny * 0.08; // Poprawiono z 0.06 na 0.08
                    // ^ --- KONIEC POPRAWKI --- ^
                    const sfMiloszBrutto = sfMiloszNetto * (1 + VAT_RATE);
                    const sfBafNetto = wpsFinalny * naszeSfProc; 
                    const sfBafBrutto = sfBafNetto * (1 + VAT_RATE); 

                    const sumSfNetto = sfMiloszNetto + sfBafNetto; 
                    const sumSfBrutto = sfMiloszBrutto + sfBafBrutto; 

                    const zyskKlienta = sumDoOdzyskania - sumPreIiBrutto - sumSfBrutto;
                    const podzialKlient = sumDoOdzyskania > 0 ? zyskKlienta / sumDoOdzyskania : 0;
                    const podzialNasz = 1 - podzialKlient;
                    
                    const roi = (sumPreBrutto > 0) ? (zyskKlienta / sumPreBrutto) : 0;
                    
                    const kwotaDoRozlozenia = sumPreBrutto;
                    
                    const prowizja5 = kwotaDoRozlozenia * PAYU_RATES[5];
                    const rata5 = (kwotaDoRozlozenia + prowizja5) / 5;
                    const zysk5 = preBafNetto - (prowizja5 / (1 + VAT_RATE)); 

                    const prowizja10 = kwotaDoRozlozenia * PAYU_RATES[10];
                    const rata10 = (kwotaDoRozlozenia + prowizja10) / 10;
                    const zysk10 = preBafNetto - (prowizja10 / (1 + VAT_RATE)); 

                    const prowizja20 = kwotaDoRozlozenia * PAYU_RATES[20];
                    const rata20 = (kwotaDoRozlozenia + prowizja20) / 20;
                    const zysk20 = preBafNetto - prowizja20; 

                    setValue('pre_milosz_brutto', preMiloszBrutto, formatCurrency);
                    setValue('pre_baf_brutto', preBafBrutto, formatCurrency); 
                    setValue('oplata_sadowa_brutto', oplataSadowaBrutto, formatCurrency);
                    setValue('ii_instancja_brutto', iiInstancjaBrutto, formatCurrency);
                    setValue('sum_pre_netto', sumPreNetto, formatCurrency);
                    setValue('sum_pre_brutto', sumPreBrutto, formatCurrency);
                    setValue('sum_pre_ii_netto', sumPreIiNetto, formatCurrency);
                    setValue('sum_pre_ii_brutto', sumPreIiBrutto, formatCurrency);
                    
                    setValue('odsetki_1rok', odsetki1rok, formatCurrency);
                    setValue('odsetki_2lata', odsetki2lata, formatCurrency);
                    setValue('sum_do_odzyskania', sumDoOdzyskania, formatCurrency);
                    setValue('wps_finalny', wpsFinalny, formatCurrency);
                    setValue('stosunek_pre_do_sumy', stosunekPreDoSumy, formatPercent);
                    setValue('zysk_klienta', zyskKlienta, formatCurrency);
                    setValue('roi', roi, formatPercent); 
                    setValue('podzial_klient', podzialKlient, formatPercent);
                    setValue('podzial_nasz', podzialNasz, formatPercent);

                    setValue('sf_milosz_netto', sfMiloszNetto, formatCurrency);
                    setValue('sf_milosz_brutto', sfMiloszBrutto, formatCurrency);
                    setValue('sf_baf_netto', sfBafNetto, formatCurrency); 
                    setValue('sf_baf_brutto', sfBafBrutto, formatCurrency); 
                    setValue('sum_sf_netto', sumSfNetto, formatCurrency);
                    setValue('sum_sf_brutto', sumSfBrutto, formatCurrency);
                    
                    setValue('payu_stawka_5', PAYU_RATES[5], formatPercent);
                    setValue('payu_prowizja_5', prowizja5, formatCurrency);
                    setValue('payu_rata_5', rata5, formatCurrency);
                    setValue('payu_zysk_5', zysk5, formatCurrency);

                    setValue('payu_stawka_10', PAYU_RATES[10], formatPercent);
                    setValue('payu_prowizja_10', prowizja10, formatCurrency);
                    setValue('payu_rata_10', rata10, formatCurrency);
                    setValue('payu_zysk_10', zysk10, formatCurrency);

                    setValue('payu_stawka_20', PAYU_RATES[20], formatPercent);
                    setValue('payu_prowizja_20', prowizja20, formatCurrency);
                    setValue('payu_rata_20', rata20, formatCurrency);
                    setValue('payu_zysk_20', zysk20, formatCurrency);

                } catch (error) {
                    console.error("Błąd obliczeń:", error);
                }
            }

            function resetForm() {
                document.getElementById('wps').value = "0";
                document.getElementById('odsetki_przyszle').value = "0";
                document.getElementById('pre_baf_netto').value = "0"; 
                
                document.getElementById('stawka_odsetek_ust').value = "10.00";
                document.getElementById('nasze_sf_proc').value = "0";
                
                calculate();
            }

            function initializeForm() {
                for (const [id, value] of Object.entries(defaultValues)) {
                    const element = document.getElementById(id);
                    if(element) {
                        element.value = value;
                    }
                }
                calculate();
            }
            
            const payuTableRows = document.querySelectorAll('.calc-section:last-of-type .calc-table tbody tr');
            payuTableRows.forEach((row, index) => {
                if (index === payuTableRows.length - 1) {
                    const cell = row.querySelector('.profit-column-cell');
                    if(cell) {
                        cell.style.borderBottom = '2px solid #a7f3d0';
                    }
                }
            });

            inputs.forEach(input => input.addEventListener('input', calculate));
            document.getElementById('reset-btn').addEventListener('click', resetForm);

            
            // V --- LOGIKA GENEROWANIA PODSTRONY --- V
            
            const generatePageBtn = document.getElementById('generate-page-btn');
            
            generatePageBtn.addEventListener('click', () => {
                const dataToStore = {
                    wps: formatCurrency(getValue('wps')),
                    sum_pre_brutto: document.getElementById('sum_pre_brutto').textContent,
                    ii_instancja_brutto: document.getElementById('ii_instancja_brutto').textContent,
                    sum_do_odzyskania: document.getElementById('sum_do_odzyskania').textContent,
                    zysk_klienta: document.getElementById('zysk_klienta').textContent,
                    roi: document.getElementById('roi').textContent,
                    stosunek_pre_do_sumy: document.getElementById('stosunek_pre_do_sumy').textContent,
                    sum_sf_brutto: document.getElementById('sum_sf_brutto').textContent,
                    podzial_klient: document.getElementById('podzial_klient').textContent,
                    podzial_nasz: document.getElementById('podzial_nasz').textContent,
                    payu_rata_5: document.getElementById('payu_rata_5').textContent,
                    payu_rata_10: document.getElementById('payu_rata_10').textContent,
                    payu_rata_20: document.getElementById('payu_rata_20').textContent,
                    payu_prowizja_5: document.getElementById('payu_prowizja_5').textContent,
                    payu_prowizja_10: document.getElementById('payu_prowizja_10').textContent,
                    payu_prowizja_20: document.getElementById('payu_prowizja_20').textContent
                };

                for (const [key, value] of Object.entries(dataToStore)) {
                    sessionStorage.setItem(`skd_data_${key}`, value);
                }
                
                window.open('oferta_skd.html', '_blank');
            });
            
            // ^ --- KONIEC LOGIKI GENEROWANIA PODSTRONY --- ^
            
            
            // V --- NOWA LOGIKA: PRZEKIEROWANIE DO GENERATORA Z DANYMI --- V
            const goToGeneratorBtn = document.getElementById('go-to-generator-btn');
            goToGeneratorBtn.addEventListener('click', () => {
                // 1. Pobierz opłatę początkową (ZMIANA LOGIKI Z TWOJEJ PROŚBY)
                const preBafNetto = getValue('pre_baf_netto');
                const oplataDoPrzekazania = preBafNetto + 2000; // NOWA LOGIKA: Pre opłaty BAF + 2 000 zł
                
                // 2. Pobierz Success Fee (Miłosz 8% + Nasze SF)
                const sfMiloszProc = 8; // Na podstawie Twojego kalkulatora
                const sfBafProc = getValue('nasze_sf_proc');
                const procentDoPrzekazania = sfMiloszProc + sfBafProc;
                
                // 3. Zbuduj URL i przekieruj (ZMIANA NAZWY PLIKU)
                const url = `generator_umowy.html?pre_oplata=${oplataDoPrzekazania}&procent=${procentDoPrzekazania}`;
                window.open(url, '_self'); // Otwórz w tej samej karcie
            });
            // ^ --- KONIEC NOWEJ LOGIKI --- ^
            
            
            initializeForm();
        });
    </script>
</html>

    <script>
        try {
            
            const dzisiaj = 'Dane na dzień: 05.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzień: 05.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        // BAF AUTO UPDATE - 05.12.2025
        try {
            document.getElementById('wibor-1m').textContent = '4,18%';
            document.getElementById('wibor-3m').textContent = '4,12%';
            document.getElementById('wibor-6m').textContent = '3,97%';
            document.getElementById('odsetki-opoznienie').textContent = '9,5%';
            
            const dzisiaj = 'Dane na dzień: 05.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    </body>
    