<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Szablon E-mail - Oferta Kredytowa</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&family=Pacifico&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; padding: 40px; background-color: #f4f7f9; font-family: 'Lato', Arial, sans-serif; box-sizing: border-box; }
        #back-controls-container { position: fixed; top: 20px; left: 30px; z-index: 1000; width: 140px; font-family: 'Lato', Arial, sans-serif; }
        #controls-container { position: fixed; top: 20px; right: 30px; z-index: 1000; width: 280px; font-family: 'Lato', Arial, sans-serif; }
        
        #copyButton, #backButton {
            padding: 10px 15px;
            font-size: 16px;
            font-weight: bold;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            outline: none;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: background-color 0.3s ease, transform 0.2s ease;
            width: 100%;
        }
        #copyButton:active, #backButton:active { transform: scale(0.98); }

        #copyButton { background-color: #e5369a; }
        #copyButton:hover { background-color: #be185d; }
        #copyButton.copied { background-color: #28a745; }

        #backButton { background-color: #5F7A95; }
        #backButton:hover { background-color: #4e657b; }

        #separator { border-bottom: 1px solid #ccc; margin: 15px 0; }
        #subject-menu { background-color: #f8f9fa; border-radius: 5px; padding: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        #subject-menu h3 { margin: 0 0 10px 0; font-size: 16px; color: #333; text-align: center; }
        .subject-category { font-size: 12px; font-weight: bold; color: #6c757d; text-transform: uppercase; margin: 15px 0 8px 0; padding-bottom: 3px; border-bottom: 1px solid #dee2e6; }
        .subject-category:first-of-type { margin-top: 5px; }
        .subject-button { display: block; width: 100%; padding: 8px 10px; margin-bottom: 8px; font-size: 14px; color: #be185d; background-color: #ffffff; border: 1px solid #e5369a; border-radius: 4px; cursor: pointer; text-align: left; transition: background-color 0.3s ease, color 0.3s ease; }
        .subject-button:hover { background-color: #e5369a; color: #ffffff; }
        .subject-button:last-child { margin-bottom: 0; }
        .subject-button.copied { background-color: #d4edda; border-color: #c3e6cb; color: #155724; }
    </style>
</head>
<body>

    <div id="back-controls-container">
        <button id="backButton" onclick="history.back()">Powr贸t</button>
    </div>

    <div id="controls-container">
        <button id="copyButton">Kopiuj tre maila (grafika)</button>
        <div id="separator"></div>
        <div id="subject-menu">
            <h3>Wybierz i skopiuj tytu maila:</h3>
            <div id="subject-buttons-container">
            </div>
        </div>
    </div>
    
    <div id="email-content-wrapper">
    </div>

    <script>
        function copySubject(button, text) {
            navigator.clipboard.writeText(text).then(() => {
                const originalText = button.innerHTML;
                button.textContent = 'Skopiowano!';
                button.classList.add('copied');
                
                document.querySelectorAll('.subject-button').forEach(btn => {
                    if (btn !== button && btn.classList.contains('copied')) {
                        btn.innerHTML = btn.getAttribute('data-original-text');
                        btn.classList.remove('copied');
                    }
                });
                button.setAttribute('data-original-text', originalText);

                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                console.error('Bd kopiowania tematu: ', err);
                button.textContent = 'Bd!';
                setTimeout(() => {
                    button.innerHTML = button.getAttribute('data-original-text');
                }, 2000);
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const netLoanAmount = params.get('netLoanAmount') || '[Kwota Kredytu]';

            // --- 1. Generowanie przycisk贸w z tytuami maili ---
            const subjectContainer = document.getElementById('subject-buttons-container');
            const subjects = `
                <h4 class="subject-category">Wariant bezporedni</h4>
                <button class="subject-button" onclick="copySubject(this, ' Kalkulacja kredytu na kwot ${netLoanAmount}')"> Kalkulacja kredytu na kwot ${netLoanAmount}</button>
                <button class="subject-button" onclick="copySubject(this, ' Podsumowanie symulacji kredytowej')"> Podsumowanie symulacji kredytowej</button>
                <h4 class="subject-category">Wariant skupiony na korzyciach</h4>
                <button class="subject-button" onclick="copySubject(this, ' Pastwa propozycja finansowania jest gotowa!')"> Pastwa propozycja finansowania jest gotowa!</button>
                <button class="subject-button" onclick="copySubject(this, ' Jak mo偶e wyglda Pastwa kredyt? Podsumowanie')"> Jak mo偶e wyglda Pastwa kredyt? Podsumowanie</button>
            `;
            subjectContainer.innerHTML = subjects;

            // --- 2. Generowanie treci maila z nowym, graficznym ukadem ---
            const emailWrapper = document.getElementById('email-content-wrapper');
            const emailBody = `
            <table border="0" cellpadding="0" cellspacing="0" width="100%" role="presentation" style="background-color: #f4f7f9;">
                <tr>
                    <td align="center">
                        <table border="0" cellpadding="0" cellspacing="0" width="100%" role="presentation" style="max-width: 800px; font-family: 'Poppins', sans-serif; background: linear-gradient(45deg, #fbcfe8, #fce7f3); border-radius: 30px; padding: 40px 50px; border: 2px solid #fff;">
                            <tr>
                                <td>
                                    <h1 style="font-family: 'Pacifico', cursive; text-align: center; font-weight: 400; color: #e5369a; font-size: 40px; text-shadow: 2px 2px #fff; margin-top: 0; margin-bottom: 25px;">
                                        Twoja Symulacja Kredytowa
                                    </h1>
                                    <p style="font-size: 17px; color: #831843; margin: 0 0 35px 0; line-height: 1.6; text-align: center;">
                                        Dzie dobry, w nawizaniu do naszej rozmowy, przesyam podsumowanie przygotowanej symulacji kredytowej.
                                    </p>
                                    
                                    <div style="background: rgba(255,255,255,0.7); border-radius: 20px; padding: 30px;">
                                        
                                        <div style="background-color: #e5369a; color: white; border-radius: 15px; padding: 20px; text-align: center; margin-bottom: 20px; box-shadow: 0 8px 20px rgba(229, 54, 154, 0.4);">
                                            <div style="font-size: 16px; font-weight: 500; opacity: 0.9; margin-bottom: 5px;">Miesiczna rata r贸wna</div>
                                            <div style="font-size: 42px; font-weight: 700; line-height: 1.2;">${params.get('monthlyPayment')}</div>
                                        </div>

                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; text-align: center;">
                                            
                                            <div style="background: #fce7f3; border-radius: 15px; padding: 20px;">
                                                <img src="https://img.icons8.com/pastel-glyph/50/e5369a/wallet--v1.png" alt="Ikona portfela" width="32" height="32" style="margin-bottom: 8px;">
                                                <div style="font-size: 14px; color:#be185d; margin-bottom: 5px;">Kwota do dyspozycji</div>
                                                <div style="font-size: 18px; font-weight: 700; color:#831843;">${params.get('clientAmount')}</div>
                                            </div>

                                            <div style="background: #fce7f3; border-radius: 15px; padding: 20px;">
                                                <img src="https://img.icons8.com/pastel-glyph/50/e5369a/calendar--v1.png" alt="Ikona kalendarza" width="32" height="32" style="margin-bottom: 8px;">
                                                <div style="font-size: 14px; color:#be185d; margin-bottom: 5px;">Okres kredytowania</div>
                                                <div style="font-size: 18px; font-weight: 700; color:#831843;">${params.get('loanTerm')} msc</div>
                                            </div>
                                            
                                            <div style="background: #fce7f3; border-radius: 15px; padding: 20px;">
                                                <img src="https://img.icons8.com/ios-glyphs/32/e5369a/percentage.png" alt="Ikona procentu" width="32" height="32" style="margin-bottom: 8px;">
                                                <div style="font-size: 14px; color:#be185d; margin-bottom: 5px;">RRSO</div>
                                                <div style="font-size: 18px; font-weight: 700; color:#831843;">${params.get('apr')}</div>
                                            </div>

                                            <div style="background: #fce7f3; border-radius: 15px; padding: 20px;">
                                                <img src="https://img.icons8.com/pastel-glyph/50/e5369a/price-tag--v1.png" alt="Ikona kosztu" width="32" height="32" style="margin-bottom: 8px;">
                                                <div style="font-size: 14px; color:#be185d; margin-bottom: 5px;">Cakowity koszt</div>
                                                <div style="font-size: 18px; font-weight: 700; color:#831843;">${params.get('totalLoanCost')}</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <p style="font-size: 12px; color: #be185d; text-align: center; margin: 35px 0 0 0; font-style: italic; line-height: 1.6;">
                                        Powy偶sza oferta ma charakter informacyjny i nie stanowi oferty handlowej w rozumieniu art. 66 搂1 Kodeksu Cywilnego.
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
            `;
            emailWrapper.innerHTML = emailBody;
            
            // --- 3. Logika g贸wnego przycisku kopiowania (kopiuje HTML) ---
            const copyBtn = document.getElementById('copyButton');
            copyBtn.addEventListener('click', () => {
                const htmlContent = emailWrapper.innerHTML;
                const blob = new Blob([htmlContent], { type: 'text/html' });
                const richTextInput = new ClipboardItem({ 'text/html': blob });

                navigator.clipboard.write([richTextInput]).then(() => {
                    copyBtn.textContent = 'Skopiowano tre';
                    copyBtn.classList.add('copied');
                    setTimeout(() => {
                        copyBtn.textContent = 'Kopiuj tre maila (grafika)';
                        copyBtn.classList.remove('copied');
                    }, 2000);
                }).catch(err => {
                    console.error('Bd kopiowania: ', err);
                    copyBtn.textContent = 'Bd!';
                     setTimeout(() => {
                        copyBtn.textContent = 'Kopiuj tre maila (grafika)';
                    }, 2000);
                });
            });
        });
    </script>
</html>

    <script>
        try {
            
            const dzisiaj = 'Dane na dzie: 05.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzie: 05.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzie: 05.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzie: 08.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzie: 10.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzie: 15.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzie: 17.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzie: 08.01.2026';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzie: 16.01.2026';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzie: 22.01.2026';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzie: 26.01.2026';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzie: 02.02.2026';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzie: 05.02.2026';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        // BAF AUTO UPDATE - 10.02.2026
        try {
            document.getElementById('wibor-1m').textContent = '4,03%';
            document.getElementById('wibor-3m').textContent = '3,88%';
            document.getElementById('wibor-6m').textContent = '3,77%';
            document.getElementById('odsetki-opoznienie').textContent = '9,5%';
            
            const dzisiaj = 'Dane na dzie: 10.02.2026';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    </body>
    