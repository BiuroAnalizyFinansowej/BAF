<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator - Oko Saurona</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Roboto&display=swap" rel="stylesheet">
    <style>
        :root {
            --sauron-fire: #f97316; --sauron-lava: #dc2626; --sauron-dark: #0c0a09;
            --sauron-ash: #292524; --sauron-text: #e7e5e4;
        }
        body {
            font-family: 'Roboto', sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh;
            background-color: var(--sauron-dark); background-image: url('https://www.transparenttextures.com/patterns/cracks.png');
            color: var(--sauron-text);
        }
        .calculator-container {
            position: relative;
            width: 100%; max-width: 800px; background-color: rgba(12, 10, 9, 0.8);
            backdrop-filter: blur(5px); padding: 2.5rem; border: 2px solid var(--sauron-ash);
            box-shadow: 0 0 30px rgba(249, 115, 22, 0.3);
        }
        .home-button, .back-button {
            position: absolute;
            top: 15px;
            width: 45px;
            height: 45px;
            background: var(--sauron-dark);
            border: 2px solid var(--sauron-ash);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            cursor: pointer;
            z-index: 10;
        }
        .home-button { left: 15px; }
        .back-button { left: 70px; }
        .home-button:hover, .back-button:hover {
            border-color: var(--sauron-fire);
            box-shadow: 0 0 10px var(--sauron-fire);
        }
        .home-button svg, .back-button svg {
            width: 24px;
            height: 24px;
            fill: var(--sauron-lava);
            transition: fill 0.2s;
        }
        .home-button:hover svg, .back-button:hover svg {
            fill: var(--sauron-fire);
        }
        .info-panel {
            position: fixed; top: 20px; right: 20px; width: 220px;
            background-color: rgba(12, 10, 9, 0.8); backdrop-filter: blur(5px);
            border: 2px solid var(--sauron-ash);
            padding: 12px; box-shadow: 0 0 30px rgba(249, 115, 22, 0.3); z-index: 1000;
        }
        .info-panel .info-container { padding: 10px; background-color: var(--sauron-dark); border: 1px solid var(--sauron-ash); }
        .info-panel .info-container:first-of-type { margin-bottom: 15px; }
        .info-header { font-family: 'Cinzel Decorative', cursive; font-size: 12px; color: var(--sauron-fire); margin-bottom: 5px; }
        .info-date { font-size: 10px; color: var(--sauron-text); margin-bottom: 10px; }
        .rates-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; text-align: center; }
        .rate-item p { margin: 0; font-size: 10px; }
        .rate-item .value, .info-container-single .value { font-weight: 700; font-size: 14px; color: var(--sauron-lava); }
        .disclaimer-text { font-size: 9px; font-style: italic; color: var(--sauron-text); margin-top: 10px; padding: 0 5px; }

        h1, h2 { font-family: 'Cinzel Decorative', cursive; text-align: center; margin-bottom: 2.5rem; font-weight: 700; color: var(--sauron-fire); text-shadow: 0 0 10px var(--sauron-lava); }
        .input-group label { font-family: 'Cinzel Decorative', cursive; font-weight: 700; margin-bottom: 0.75rem; display: block; }
        input[type="text"], input[type="number"] { border: 2px solid var(--sauron-ash); background: var(--sauron-dark); width: 150px; padding: 0.75rem; font-size: 1rem; font-weight: 600; color: var(--sauron-text); text-align: center; transition: all 0.3s; }
        input[type="text"]:focus, input[type="number"]:focus { outline: none; border-color: var(--sauron-fire); box-shadow: 0 0 10px var(--sauron-fire); }
        input[type="range"] { -webkit-appearance: none; appearance: none; width: 100%; background: transparent; cursor: pointer; }
        input[type="range"]::-webkit-slider-runnable-track { background-color: var(--sauron-ash); height: 4px; border-radius: 4px; border: 1px solid var(--sauron-dark); }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; margin-top: -16px; height: 36px; width: 24px; border-radius: 50%; border: 2px solid var(--sauron-fire); background: linear-gradient(to right, transparent 45%, #0c0a09 45%, #0c0a09 55%, transparent 55%), radial-gradient(circle at center, var(--sauron-fire), var(--sauron-lava)); box-shadow: 0 0 15px var(--sauron-fire); }
        .input-wrapper{display:flex;align-items:center;gap:1rem;} .term-display{font-weight:600;white-space:nowrap;}
        .grouped-inputs{display:grid;grid-template-columns:1fr 1fr;gap:2rem;margin-top:1.5rem;border-top:2px solid var(--sauron-ash);padding-top:1.5rem;}
        .interest-rate-summary{font-family: 'Cinzel Decorative', cursive;font-weight:700;text-align:center;padding:0.75rem;border:2px solid var(--sauron-ash);color:var(--sauron-fire);}
        .output-section{margin-top:2rem;padding:1.5rem;border:2px solid var(--sauron-ash);}
        .output-row{display:flex;justify-content:space-between;align-items:center;padding:0.75rem 0;border-bottom:1px solid var(--sauron-ash);} .output-row:last-child{border-bottom:none;}
        .output-row .label{font-weight:600;} .output-row .value,.output-row .result{font-weight:700;font-size:1.2rem;}
        .output-row .result{font-size:1.8rem;color:var(--sauron-lava); font-family: 'Cinzel Decorative', cursive;}
        .output-row .client-amount{color:var(--sauron-fire);}
        table{width:100%;margin-top:2rem;border-collapse:collapse;} th,td{border:1px solid var(--sauron-ash);padding:0.75rem;text-align:right;}
        th{font-family: 'Cinzel Decorative', cursive; font-size: 1.1rem; background-color:var(--sauron-dark);font-weight:700;}
    </style>
</head>
<body>
    <div class="info-panel">
        <div class="info-container">
            <div class="info-header">Stawki Referencyjne</div>
            <div class="info-date" id="current-date-wibor">...</div>
            <div class="rates-grid">
                <div class="rate-item"><p>WIBOR 1M</p><p class="value" id="wibor-1m">...</p></div>
                <div class="rate-item"><p>WIBOR 3M</p><p class="value" id="wibor-3m">...</p></div>
                <div class="rate-item"><p>WIBOR 6M</p><p class="value" id="wibor-6m">...</p></div>
            </div>
            <p class="disclaimer-text">Dane przedstawiają wartości z podanego dnia i nie są aktualizowane automatycznie.</p>
        </div>
        <div class="info-container info-container-single">
            <div class="info-header">Odsetki ustawowe za opóźnienie</div>
            <div class="info-date" id="current-date-odsetki">...</div>
            <p class="value" id="odsetki-opoznienie">...</p>
            <p class="disclaimer-text">Dane przedstawiają wartości z podanego dnia i nie są aktualizowane automatycznie.</p>
        </div>
    </div>
    
    <div class="calculator-container">
        <a href="index.html" class="home-button" title="Strona główna">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8h5z"/></svg>
        </a>
        <a href="#" onclick="history.back(); return false;" class="back-button" title="Powrót">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
        </a>
        <h1>Skryba z Barad-dûr</h1><div class="input-group"><label for="loanAmount">Trybut (w złocie)</label><div class="input-wrapper"><input type="range" id="loanAmountSlider" min="500" max="1500000" step="500" value="300000"><input type="text" id="loanAmountInput" value="300 000"></div></div><div class="input-group"><label for="loanTerm">Cykle Ciemności</label><div class="input-wrapper"><input type="range" id="loanTermSlider" min="6" max="180" step="1" value="120"><input type="number" id="loanTermInput" min="6" max="180" step="1" value="120"><span class="term-display" id="termInYears">(10 lat i 0 miesięcy)</span></div></div><div class="grouped-inputs"><div><div class="input-group" style="margin-bottom: 1rem;"><label for="bankCommission">Dziesięcina dla Twierdzy (%)</label><input type="number" id="bankCommission" step="0.1" value="2.0"></div><div class="input-group" style="margin-bottom: 1rem;"><label for="bankMargin">Marża (%)</label><input type="number" id="bankMargin" step="0.1" value="2.5"></div><div class="input-group" style="margin-bottom: 1rem;"><label for="wibor">Dekret Władcy (%)</label><input type="number" id="wibor" step="0.01" value="5.85"></div><div class="interest-rate-summary" id="nominalInterestRate">Oprocentowanie nominalne: 8.35%</div></div><div><div class="input-group" style="margin-bottom: 1rem;"><label for="brokerFeePercent">Dola Nazgûla (%)</label><input type="number" id="brokerFeePercent" placeholder="np. 3.0"></div><div class="input-group" style="margin-bottom: 1rem;"><label for="brokerFeeAmount">...w złocie</label><input type="number" id="brokerFeeAmount" placeholder="np. 9000"></div></div></div><div class="output-section"><div class="output-row"><span class="label">Kapitał długu</span><span class="value" id="netLoanAmount">0,00 zł</span></div><div class="output-row"><span class="label">Całkowite zobowiązanie</span><span class="value" id="grossLoanAmount">0,00 zł</span></div><div class="output-row"><span class="label">Złoto do ręki</span><span class="value client-amount" id="clientAmount">0,00 zł</span></div><div class="output-row"><span class="label">Miesięczna ofiara</span><span class="result" id="monthlyPayment">0,00 zł</span></div></div><h2 style="margin-top: 2.5rem;">Spis Dłużników</h2><div style="overflow-x:auto;"><table><thead><tr><th>Nr</th><th>Kapitał</th><th>Odsetki</th><th>Rata</th><th>Pozostało</th></tr></thead><tbody id="scheduleBody"></tbody></table></div>
    </div>
    <script>
        const loanAmountSlider = document.getElementById('loanAmountSlider');const loanAmountInput = document.getElementById('loanAmountInput');const loanTermSlider = document.getElementById('loanTermSlider');const loanTermInput = document.getElementById('loanTermInput');const termInYearsDisplay = document.getElementById('termInYears');const bankCommissionInput = document.getElementById('bankCommission');const bankMarginInput = document.getElementById('bankMargin');const wiborInput = document.getElementById('wibor');const brokerFeePercentInput = document.getElementById('brokerFeePercent');const brokerFeeAmountInput = document.getElementById('brokerFeeAmount');const nominalInterestRateDisplay = document.getElementById('nominalInterestRate');const netLoanAmountDisplay = document.getElementById('netLoanAmount');const grossLoanAmountDisplay = document.getElementById('grossLoanAmount');const monthlyPaymentDisplay = document.getElementById('monthlyPayment');const clientAmountDisplay = document.getElementById('clientAmount');const scheduleBody = document.getElementById('scheduleBody');const currencyFormatter = new Intl.NumberFormat('pl-PL', { style: 'currency', currency: 'PLN' });const numberFormatter = new Intl.NumberFormat('pl-PL', { minimumFractionDigits: 0, maximumFractionDigits: 0 });function formatInputValue(value) {return numberFormatter.format(value).replace(/\s/g, ' ');}function parseFormattedValue(value) {return parseFloat(value.replace(/\s/g, '').replace(',', '.')) || 0;}function calculate() {const loanAmount = parseFormattedValue(loanAmountInput.value);const loanTerm = parseInt(loanTermInput.value) || 0;const bankCommission = parseFloat(bankCommissionInput.value) || 0;const bankMargin = parseFloat(bankMarginInput.value) || 0;const wibor = parseFloat(wiborInput.value) || 0;const brokerFeeAmount = parseFloat(brokerFeeAmountInput.value) || 0;const years = Math.floor(loanTerm / 12);const months = loanTerm % 12;termInYearsDisplay.textContent = `(${years} lat i ${months} miesięcy)`;const nominalInterestRate = bankMargin + wibor;nominalInterestRateDisplay.textContent = `Oprocentowanie nominalne: ${nominalInterestRate.toFixed(2)}%`;const grossLoanAmount = loanAmount * (1 + bankCommission / 100);netLoanAmountDisplay.textContent = currencyFormatter.format(loanAmount);grossLoanAmountDisplay.textContent = currencyFormatter.format(grossLoanAmount);const monthlyInterestRate = (nominalInterestRate / 100) / 12;let monthlyPayment = 0;if (monthlyInterestRate > 0 && loanTerm > 0) {const factor = Math.pow(1 + monthlyInterestRate, loanTerm);monthlyPayment = grossLoanAmount * (monthlyInterestRate * factor) / (factor - 1);} else if (loanTerm > 0) {monthlyPayment = grossLoanAmount / loanTerm;}monthlyPaymentDisplay.textContent = currencyFormatter.format(monthlyPayment);const clientAmount = loanAmount - brokerFeeAmount;clientAmountDisplay.textContent = currencyFormatter.format(clientAmount);generateSchedule(grossLoanAmount, monthlyPayment, monthlyInterestRate, loanTerm);}function generateSchedule(principal, monthlyPayment, monthlyRate, term) {scheduleBody.innerHTML = '';let remainingPrincipal = principal;if (term === 0 || isNaN(monthlyPayment) || !isFinite(monthlyPayment)) return;for (let i = 1; i <= term; i++) {const interestPart = remainingPrincipal * monthlyRate;let principalPart = monthlyPayment - interestPart;if (i === term) {principalPart = remainingPrincipal;monthlyPayment = principalPart + interestPart;}remainingPrincipal -= principalPart;const row = `<tr><td>${i}</td><td>${currencyFormatter.format(principalPart)}</td><td>${currencyFormatter.format(interestPart)}</td><td>${currencyFormatter.format(monthlyPayment)}</td><td>${currencyFormatter.format(Math.abs(remainingPrincipal))}</td></tr>`;scheduleBody.innerHTML += row;}}const inputsToCalculate = [loanAmountSlider, loanTermSlider, loanTermInput, bankCommissionInput, bankMarginInput, wiborInput, brokerFeePercentInput, brokerFeeAmountInput];inputsToCalculate.forEach(input => input.addEventListener('input', calculate));loanAmountInput.addEventListener('change', calculate);loanAmountSlider.addEventListener('input', () => {loanAmountInput.value = formatInputValue(loanAmountSlider.value);});loanAmountInput.addEventListener('input', (e) => {let value = parseFormattedValue(e.target.value);if (value > 1500000) value = 1500000;if (value >= 500) {loanAmountSlider.value = value;}});loanAmountInput.addEventListener('blur', (e) => {let value = parseFormattedValue(e.target.value);if (value < 500) value = 500;e.target.value = formatInputValue(value);calculate();});loanTermSlider.addEventListener('input', () => loanTermInput.value = loanTermSlider.value);loanTermInput.addEventListener('input', () => loanTermSlider.value = loanTermInput.value);brokerFeePercentInput.addEventListener('input', () => {const loanAmount = parseFormattedValue(loanAmountInput.value);const percent = parseFloat(brokerFeePercentInput.value) || 0;const amount = (loanAmount * percent) / 100;brokerFeeAmountInput.value = amount.toFixed(2);});brokerFeeAmountInput.addEventListener('input', () => {const loanAmount = parseFormattedValue(loanAmountInput.value);const amount = parseFloat(brokerFeeAmountInput.value) || 0;if (loanAmount > 0) {const percent = (amount / loanAmount) * 100;brokerFeePercentInput.value = percent.toFixed(2);} else {brokerFeePercentInput.value = '';}});
        document.addEventListener('DOMContentLoaded', () => {
            loanAmountInput.value = formatInputValue(loanAmountSlider.value);
            calculate();
            
            const dzisiaj = 'Dane na dzień: 05.12.2025';
            document.getElementById('current-date-wibor').textContent = formattedDate;
            document.getElementById('current-date-odsetki').textContent = formattedDate;
        });
    </script>
</html>

    <script>
        try {
            
            const dzisiaj = 'Dane na dzień: 05.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzień: 05.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzień: 05.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzień: 08.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzień: 10.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        try {
            
            const dzisiaj = 'Dane na dzień: 15.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    
    <script>
        // BAF AUTO UPDATE - 17.12.2025
        try {
            document.getElementById('wibor-1m').textContent = '4,17%';
            document.getElementById('wibor-3m').textContent = '4,03%';
            document.getElementById('wibor-6m').textContent = '3,93%';
            document.getElementById('odsetki-opoznienie').textContent = '9,5%';
            
            const dzisiaj = 'Dane na dzień: 17.12.2025';
            if(document.getElementById('current-date-wibor')) document.getElementById('current-date-wibor').textContent = dzisiaj;
            if(document.getElementById('current-date-odsetki')) document.getElementById('current-date-odsetki').textContent = dzisiaj;
        } catch(e) { console.log('Brak elementu w tym pliku'); }
    </script>
    </body>
    